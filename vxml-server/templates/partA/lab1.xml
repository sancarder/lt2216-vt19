<?xml version="1.0" encoding="UTF-8"?>
<vxml version="2.1" xmlns="http://www.w3.org/2001/vxml"
      xmlns:voxeo="http://community.voxeo.com/xmlns/vxml">
  <nomatch>
    I didn't understand.
    <reprompt/>
  </nomatch>
  
  <noinput>
    You didn't say anything.
    <reprompt/>
  </noinput>

  <!-- Data model -->
  <var name="from" />
  <var name="to" />
  <var name="date" />
  <var name="return" />

  <!-- State machine -->
  <form id="welcome">
    <block>
      <prompt>
        <break time="2000" />
        Welcome to the flight booking service.
      </prompt>
      <goto next="#askFrom" />
    </block>
  </form>

  <form id="askFrom">
    <field name="fromField">
      <prompt>
        What city are you leaving from?
      </prompt>
                  
      <option>london</option>
      <option>paris</option>
      <option>new york</option>
    </field>
    <filled>
      <assign name="from" expr="fromField" />
      <goto next="#askTo" />
    </filled>
  </form>

  <form id="askTo">
    <field name="toField">
      <prompt>
        Where are you going?
      </prompt>
      <option>london</option>
      <option>paris</option>
      <option>new york</option>
    </field>
    <filled>
      <assign name="to" expr="toField" />        
      <goto next="#askDate" />
    </filled>
  </form>

  <form id="askLeaveDate">
    <field name="leaveDateField">
      <prompt>
	What date do you want to leave?
      </prompt>
      <option>Monday</option>
      <option>Tuesday></option>
      <option>Wednesday></option>
      <option>Thursday></option>
      <option>Friday></option>
    </field>
    <filled>
      <assign name="date" expr="leaveDateField" />        
      <goto next="#askOneWay"/>
    </filled>
  </form>

  <form id="askOneWay">
    <field name="OneWayField">
      <prompt>
          Is it a one-way trip?
      </prompt>
      <if cond="askOneWayField">
          <goto next="askOneWayConfirmation"/>
          <else/>
          <goto next="askReturnDate"/>
      </if>
    </field>
  </form>
  
  <form id="askReturnDate">
    <field name="returnDateField">
      <prompt>
          What date do you want to return?
      </prompt>
      <option>Monday</option>
      <option>Tuesday></option>
      <option>Wednesday></option>
      <option>Thursday></option>
      <option>Friday></option>
    </field>
    <filled>
      <assign name="return" expr="returnDateField" />        
      <goto next="#askReturnTripConfirmation"/>
    </filled>
  </form>

  <form id="askOneWayConfirmation">
    <field name="OneWayConfirmationField">
      <prompt>
          Do you want to go from <value expr="fromField"/> to <value expr="toField"/> on <value expr="leaveDateField"/>? 
      </prompt>
      <if cond="OneWayConfirmationField">
          <goto next="#confirmFlight"/>
          <else/>
          <goto next="#askFrom"/>
      </if>
    </field>
  </form>  
  
  <form id="askReturnTripConfirmation">
    <field name="ReturnTripConfirmationField">
      <prompt>
          Do you want to go from <value expr="fromField"/> to <value expr="toField"/> on <value expr="leaveDateField"/> returning on <value expr="returnDateField"/>? 
      </prompt>
      <if cond="ReturnTripConfirmationField">
          <goto next="#confirmFlight"/>
          <else/>
          <goto next="#askFrom"/>
      </if>
    </field>
  </form>    
  
  <form id="confirmFlight">
    <block>
      <prompt>
        <break time="2000" />
        Your flight has been booked!
      </prompt>
    </block>
  </form>  
  
</vxml>
